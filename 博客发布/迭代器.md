## 概念

**Iterator**翻译过来就是迭代器，那么什么是迭代器呢，引用高程的一句话

> “迭代” 的意思是按照顺序反复多次执行一段程序，通常会有明确的终止条件。****

ECMAScript 6 规范新增了两个高级特性：迭代器和生成器。





### 设计的由来

循环是迭代机制的基础，因为它可以指定迭代的次数，以及每次迭代要执行什么操作。

***

但是仅仅是需要数组中元素的值，但是**却需要提前获取数组长度，声明索引变量等**，尤其当多个循环嵌套的时候，更需要使用多个索引变量，代码的复杂度就会大大增加。



### Iterator 的作用

1. 为各种数据结构，提供一个统一的、简便的访问接口
2. 使得数据结构的成员能够按某种次序排列
3. ES6 创造了一种新的遍历命令`for...of`循环，Iterator 接口主要供`for...of`消费

### 具备iterator接口的数据

一般来说，能使用`for of`遍历的数据就是可迭代数据

- Array
- set容器
- map容器
- String
- 函数的 arguments 对象
- NodeList 对象

### 工作原理

```js

function makeIterator(array) {
  var nextIndex = 0;
  return {
    next: function() {
      return nextIndex < array.length ?
        {value: array[nextIndex++], done: false} :
        {value: undefined, done: true};
    }
  };
}

var it = makeIterator(['a', 'b']);

it.next() // { value: "a", done: false }
it.next() // { value: "b", done: false }
it.next() // { value: undefined, done: true }

```


定义一个可迭代对象的构造函数，返回一个带有`next`方法的一个对象，根据传入的值进行判断，并依次输出。

*****

也可以不接受参数，例如id生成器

```js
var it = idMaker();

it.next().value // 0
it.next().value // 1
it.next().value // 2
// ...

function idMaker() {
  var index = 0;

  return {
    next: function() {
      return {value: index++, done: false};
    }
  };
}
```


## Iterator 接口
给对象添加` Iterator` 接口的目的是，为数据结构提供一个统一的访问机制，也就是说，当使用`for...of`循环时，会自动寻找` Iterator` 接口，从而按顺序输出特定值。

ES6规定使用`Symbol.iterator`属性，来进行接口部署。

```js
const obj = {
  [Symbol.iterator] : function () {
    return {
      next: function () {
        return {
          value: 1,
          done: true
        };
      }
    };
  }
};
```

这个方法的根本特征就是返回一个带有`next`方法的对象。